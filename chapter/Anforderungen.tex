\chapter{\label{chap:anforderungen}Anforderungsdefinition}
Dieses Kapitel beschreibt die Anforderungen an die Ampelhinweis-\gls{App}. Heutzutage spielt die Benutzbarkeit und Funktionalität des Produkts eine große Rolle.\\
Aus den oben genannten Szenarien werden im Folgenden die Anforderungen hergeleitet, die die zu entwickelnde \gls{Smartphone}-Anwendung erfüllen soll. Für die Umsetzung einer solchen Applikation ist die Positions- und Geschwindigkeitsbestimmung obligatorisch. Im Zusammenhang mit den Ampeldaten, bestehend aus Lage- und Schaltplan, sollen die notwendigen Berechnungen durchgeführt und deren Ergebnisse als Empfehlung ausgesprochen werden.
% FUNKTIONALITÄT %
\section{Funktionalität}
Es soll ein System für \glspl{Smartphone} entwickelt werden, das den NutzerInnen zeigt, wie sie in der Grünen Welle durch den Verkehr gelangen, indem es eine sich angepasste Geschwindigkeitsempfehlung ausspricht.\\ 
Die Bestimmung von Position und Geschwindigkeit des Fahrrads ist die zentrale Voraussetzung für eine zeitgerechte Empfehlung. Sie sollte ebenso schnell wie präzise erfolgen, sodass keine Verzögerung der zu berechnenden Ergebnisanzeige eintritt und die Informationen eine hohe Genauigkeit aufweisen.\\
Von ebenso hoher Relevanz sind die Ampeldaten, bestehend aus der genauen Position der \gls{LSA} und deren Schaltplänen. Da nicht alle \glspl{LSA} automatisch geschaltet sind, sondern einige verkehrsabhängig gesteuert werden -- wie zum Beispiel FußgängerInnenampeln, die erst auf Druck aktiviert werden -- ist es nicht möglich, für diese eine genaue Vorhersage zu treffen. Wird die nächstgelegene Ampel als solche identifiziert, muss die Anwendung sofort signalisieren, dass keine Empfehlung zu erwarten und aufgrund der Verkehrslage zu entscheiden ist. Auch in dem Fall, dass die Ampel ausgeschaltet ist, muss diese Anzeige umgesetzt werden.\\
Die meisten Fahrradampeln sind entweder mit keiner oder einer nur sehr kurzen Gelbphase ausgestattet. Deshalb wird diese zunächst, auch bei Autoampeln, aus Sicherheitsgründen als Rotphase behandelt.
% Berechnungen
\subsection{Begrenzungsparameter}
Abschnitt \ref{sec:mathGrundlagen} legt die Berechnungsgrundlagen für die Begrenzungsparameter dar. Die ausgesprochene Empfehlung, die Geschwindigkeit zu ändern oder beizubehalten, basiert auf der berechneten Empfehlungsgeschwindigkeit und der aktuellen Geschwindigkeit. Die berechnete Geschwindigkeit ist abhängig vom Abstand zur Ampel und der verbleibenden Zeit bis die Ampel auf Rot umschaltet.\\\\
Die Berechnung bedarf sinnvoller Geschwindigkeitsparameter. Die Untergrenze wird auf 5 km/h, die Höchstgeschwindigkeit auf 30 km/h festgelegt. Die festgesetzte Höchstgeschwindigkeit von 30 km/h soll als Ausgangspunkt für die Berechnung dienen. Gegebenenfalls kann diese später individuell angepasst werden. 
%\textit{Die Obergrenze richtet sich in erster Linie nach der zulässigen Höchstgeschwindigkeit. Denn auch wenn Fahrräder nicht von den allgemeinen Geschwindigkeitsbegrenzungen der StVO nach \S 3 Abs. 1 der StVO betroffen sind, gelten per \S 3 Abs. 1 der StVO die per Schild angeordneten Geschwindigkeiten.} 
Hierbei ist insbesondere beim Erhöhen der Höchstgeschwindigkeit darauf hinzuweisen, dass auch für FahrradfahrerInnen die durch Verkehrsschilder ausgeschriebene Geschwindigkeitsbegrenzungen der StVO nach \S 3 Abs. 1 gelten und Vorrang haben. \\
Ebenfalls zu beachten ist die aufzubringende Beschleunigung. Laut \cite{beschleunigung} liegt die mögliche Beschleunigung bei FahrradfahrerInnen zwischen ein und zwei m/s$^{2}$. Wird die berechnete Geschwindigkeit mit der aktuellen und den Begrenzungsparametern ins Verhältnis gesetzt, ist die Empfehlung abzuleiten.\\\\ 
Die Prognose findet statt, sobald die Ampel 300 Meter voraus liegt. Bei einer größeren Entfernung von zum Beispiel einem Kilometer kann die Gefahr der Ablenkung der FahrerInnen bestehen. Bei einer Entfernung von 300 Metern genügt es, für den zu entwickelnden Prototyp den Abstand in Luftlinie zu berechnen. Bei Optimierungsbedarf bietet es sich hierfür an, Straßendaten einzubinden, um den genauen Abstand ermitteln zu können. Hierbei werden dann beeinflussende Elemente wie Hügel oder Kurven berücksichtigt.\\\\
Außerdem muss ermittelt werden, welche Ampel die nächste ist, um dann die Entfernung zu dieser zu berechnen. Da keine Straßendaten vorliegen werden, zunächst alle Ampeln im genannten Radius von 300 Metern geortet und deren Distanz errechnet.
% Datengrundlage
\subsection{Datengrundlagen}
Die Positionsdaten, die Information zur Verkehrsabhängigkeit und die Schaltpläne, bestehend aus geltender Wochentage, Start- und Endzeit des Schaltplans, sowie der Start- und Endzeit der Grünphase befinden sich in einer \gls{JSON}-Datei, welche im internen Speicher abgelegt ist, wodurch sich Abfragen zu externen Servern, die eine Verbindung mit einem Netzwerk voraussetzen erübrigen. Diese sollte allein aus Performancegründen keinen Internetzugriff voraussetzen, da ein direkter Zugriff auf den internen Speicher nicht den Umweg über einen Server gehen muss. Wenn das Datenvolumen aufgebraucht, oder die Netzwerkverbindung zu langsam ist, dauert die Datenanfrage zu lang.\\
Die Ampeldaten müssen manuell erfasst und in ein geeignetes Format gebracht werden. Es gibt verschiedene Formate, die sich hierbei anbieten. Im Rahmen dieser Bachelorarbeit wurde entschieden, die Ampeldaten in einer Datei per Hand aufzubereiten. Da sowohl die Ampelpositionsdaten als auch die Ampelschaltpläne statisch sind, werden sie nur gelesen und nicht verändert, wofür bei der begrenzten Anzahl von Ampeln im Testgebiet keine Datenbank vonnöten ist. Weiterhin braucht eine Datei weder Treiber noch Bibliothek, was den Overhead\footnote{ Zusatzinformationen} gering hält. 
Bei einer ggf. späteren Einbindung des gesamten Stadtbildes oder der Erweiterung über zusätzliche Städte ist über ein optimiertes Datenmodell nachzudenken. \\\\
In der zu entwickelnden Anwendung muss die Positionsbestimmung sehr genau sein. Ob die Genauigkeit des integrierten \gls{GPS}-Sensors genügt, muss ergo im Rahmen dieser Arbeit getestet werden. \\
Eine Möglichkeit dem hohen Akkuverbrauch von \gls{GPS} entgegenzuwirken wäre die Verwendung eines externen \gls{GPS}-Geräts, das über Bluetooth mit dem \gls{Smartphone} verbunden ist und so dessen Akkulaufzeit verlängert. Außerdem ist die Qualität des \gls{GPS}-Empfängers höher als die des im \gls{Smartphone} verbauten und kann somit eine präzisere Ortung erlangen (vgl. \cite{gps} S. 28). Der Nachteil hierbei ist die Notwendigkeit eines zweiten Gerätes, das an bestimmte Smartphones nicht angeschlossen werden kann. 
% DESIGN %
%\clearpage
\section{Die graphische Oberfläche}
Ebenso wie die Bestimmung von Position und Geschwindigkeit ist auch die graphische Darstellung von großer Bedeutung. Gerade beim Gebrauch im Straßenverkehr ist die Eindeutigkeit und schnelle Erfassbarkeit der zu übermittelnden Informationen bedeutend. Um nicht vom Verkehr abzulenken, muss die Information, sowohl in Bedeutung als auch in Darstellung auf einen kurzen Blick erkennbar sein. Demnach sollte die Oberfläche möglichst einfach gehalten werden.
\subsection{Sicherheitshinweise}
Da die Anwendung während der Fahrt nicht bedient werden -- denn das Bedienen würde vom Verkehr ablenken -- dürfen keine Bedienelemente eingeblendet werden und es besteht mehr Raum für die Anzeige der Informationen. 
Es ist davon auszugehen, dass die Anwendung ausschließlich im Freien Gebrauch findet. Dies und die dort wechselnden Helligkeiten, zum Beispiel bei der Fahrt unter Bäumen, setzen eine Verwendung von hohen Kontrasten voraus.\\ 
Weiter muss das automatische Abschalten des Gerätebildschirms deaktiviert werden, sodass sich dieser auch ohne Interaktion nicht ausschaltet und die Anwendung den FahrerInnen jederzeit unterstützende Fahranweisungen geben kann. \\\\
Im Allgemeinen sollte die Anwendung in der Lage sein, die aus Kapitel \ref{chap:szenarien} resultierenden fünf Systemzustände zu visualisieren und gegebenenfalls eine entsprechende Empfehlung auszusprechen. Es muss ausdrücklich darauf hingewiesen werden, dass es sich bei den Empfehlungen um eben solche handelt und man diese nur befolgen darf, wenn es die Umstände und die Verkehrsregeln erlauben. Ebenso sollte darauf hingewiesen werden, nicht zu lange auf das ausführende Gerät zu schauen und die Aufmerksamkeit hauptsächlich dem Verkehr zu widmen.
\subsection{Farbschema}
Zur Verdeutlichung und einfacher Erfassbarkeit der angezeigten Empfehlungen bietet es sich an, die entsprechenden Farben zu nehmen. Also ist für Zustand \textit{b}, der das Erreichen der Grünen Welle ohne Veränderung der eigenen Geschwindigkeit steht, Grün zu verwenden. Für den Zustand \textit{a}, der ausdrückt, dass das Anhalten an roter Ampel in jedem Fall erforderlich ist, ist Rot zu verwenden.
Die Zustände \textit{c} und \textit{d} drücken aus, ein Erreichen der Grünen Welle ist möglich, jedoch nur bei Veränderung der eigenen Fahrgeschwindigkeit. Zur inhaltlichen Differenzierung ist eine andere Farbe zu wählen, sodass bereits aus dem Augenwinkel eine Handlungsempfehlung erkennbar ist. Dahingehend soll ersichtlich sein, ob das Tempo leicht oder stark erhöht bzw. verlangsamt werden muss. Wird die Empfehlung der leichten Geschwindigkeitverlangsamung ausgesprochen, muss auch das ersichtlich sein.\\
Unterstützend zur Handlungsaufforderung kann ein Countdown angezeigt werden, der die Dauer der jeweiligen Ampelphase herunterzählt. 
